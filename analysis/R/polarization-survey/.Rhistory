theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Calculate total counts for each ParticipantLeaning
totals <- leaning_fact %>%
group_by(ParticipantLeaning) %>%
summarise(Total = n())
# Plot with total labels on top of bars
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
geom_text(
data = totals,
aes(x = ParticipantLeaning, y = Total, label = Total),
vjust = -0.5, # Position above the bar
size = 4,
fontface = "bold"
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Calculate total counts for each ParticipantLeaning
totals <- df_unique %>%
group_by(ParticipantLeaning) %>%
summarise(Total = n())
# Calculate total counts for each ParticipantLeaning
totals <- leaning_fact %>%
group_by(ParticipantLeaning) %>%
summarise(Total = n())
# Plot with total labels on top of bars
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
geom_text(
data = totals,
aes(x = ParticipantLeaning, y = Total, label = Total),
vjust = -0.5, # Position above the bar
size = 4,
fontface = "bold"
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Calculate total counts for each ParticipantLeaning
totals <- leaning_fact %>%
group_by(ParticipantLeaning) %>%
summarise(Total = n())
# Plot with total labels on top of bars
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
geom_text(
data = totals,
aes(x = ParticipantLeaning, y = Total, label = Total),
vjust = -0.5, # Position above the bar
size = 4,
fontface = "bold"
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
geom_text(
stat = "count",
aes(label = after_stat(count)),
vjust = -0.5, # Position above the bar
size = 4,
fontface = "bold"
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
geom_text(
stat = "count",
aes(label = after_stat(count)),
vjust = -0.5, # Position above the bar
size = 4,
fontface = "bold"
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
ggsave("participant_leaning_count.pdf",
plot = last_plot(),  # Use the last plot created
device = "pdf",      # Specify PDF format
width = 8,           # Set width of the PDF (in inches)
height = 6,          # Set height of the PDF (in inches)
units = "in",        # Units for width and height
dpi = 300)
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
ggsave("participant_leaning_count.png",
plot = last_plot(),   # Use the last plot created
device = "png",       # Specify PNG format
width = 8,            # Set width of the PNG (in inches)
height = 6,           # Set height of the PNG (in inches)
units = "in",         # Units for width and height
dpi = 300)
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
participant_leaning
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
participant_leaning()
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
participant_leaning
ggsave("participant_leaning_count.png",
plot = participant_leaning,   # Use the last plot created
device = "png",       # Specify PNG format
width = 8,            # Set width of the PNG (in inches)
height = 6,           # Set height of the PNG (in inches)
units = "in",         # Units for width and height
dpi = 300)
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_minimal()
participant_leaning
ggsave("participant_leaning_count.png",
plot = participant_leaning,   # Use the last plot created
device = "png",       # Specify PNG format
width = 8,            # Set width of the PNG (in inches)
height = 6,           # Set height of the PNG (in inches)
units = "in",         # Units for width and height
bg = "white",
dpi = 300)
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_grey()
participant_leaning
ggsave("participant_leaning_count.png",
plot = participant_leaning,   # Use the last plot created
device = "png",       # Specify PNG format
width = 8,            # Set width of the PNG (in inches)
height = 6,           # Set height of the PNG (in inches)
units = "in",         # Units for width and height
bg = "white",
dpi = 300)
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_grey()
participant_leaning
ggsave("participant_leaning_count.png",
plot = participant_leaning,   # Use the last plot created
device = "png",       # Specify PNG format
width = 8,            # Set width of the PNG (in inches)
height = 5,           # Set height of the PNG (in inches)
units = "in",         # Units for width and height
bg = "white",
dpi = 300)
library(tidyverse)
library(ggplot2)
library(plotly)
library(dplyr)
survey_data <- read.csv('../../../backend/data/database/survey_data.csv')
#dim(survey_data)
glimpse(survey_data)
participants_data <- survey_data %>% distinct(FK_ParticipantId, ParticipantLeaning, TreatmentGroup)
glimpse(participants_data)
# Use the Okabe-Ito color-blind-friendly palette
okabe_ito_palette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# Plot with color-blind-friendly colors
participant_leaning = ggplot(leaning_fact, aes(x = ParticipantLeaning, fill = TreatmentGroup)) +
geom_bar(position = "stack", color = "black", width = 0.5) +
geom_text(
aes(label = after_stat(count)),
stat = "count",
position = position_stack(vjust = 0.5), # Places the label inside each stacked segment
size = 3
) +
scale_fill_manual(values = okabe_ito_palette) + # Apply the Okabe-Ito palette
labs(title = "Participant Leaning Count by Treatment Group",
x = "Participant Leaning",
y = "Count",
fill = "Treatment Group") +
theme_grey()
participant_leaning
ggsave("participant_leaning_count.png",
plot = participant_leaning,   # Use the last plot created
device = "png",       # Specify PNG format
width = 8,            # Set width of the PNG (in inches)
height = 5,           # Set height of the PNG (in inches)
units = "in",         # Units for width and height
bg = "white",
dpi = 300)
ggplot(survey_data, aes(x = TreatmentGroup, y = DiffLikertTreatedOriginal, fill = TreatmentGroup)) +
geom_boxplot() +
labs(title = "Boxplot of DiffLikertTreatedOriginal by Treatment Group",
x = "Treatment Group",
y = "DiffLikertTreatedOriginal") +
scale_fill_manual(values = c("human" = "#E69F00", "machine" = "#56B4E9", "placebo" = "#009E73")) +  # Optional custom colors
theme_minimal()
ggplot(survey_data, aes(x = TreatmentGroup, y = DiffLikertTreatedOriginal, fill = TreatmentGroup)) +
geom_boxplot() +
labs(title = "Boxplot of DiffLikertTreatedOriginal by Treatment Group",
x = "Treatment Group",
y = "DiffLikertTreatedOriginal") +
scale_fill_manual(values = c("human" = "#E69F00", "machine" = "#56B4E9", "placebo" = "#009E73")) +  # Optional custom colors
theme_minimal() +
theme(
plot.title = element_text(size = 18, face = "bold"),   # Larger title
axis.title = element_text(size = 14),                  # Larger axis titles
axis.text = element_text(size = 12),                   # Larger axis labels
legend.title = element_text(size = 14),                # Larger legend title
legend.text = element_text(size = 12)                  # Larger legend text
)
ggsave("boxplot_diff_likert_treated_original.pdf",
plot = last_plot(),  # Use the last plot created
device = "pdf",      # Specify PDF format
width = 8,           # Set width of the PDF (in inches)
height = 6,          # Set height of the PDF (in inches)
units = "in",        # Units for width and height
dpi = 300)
box_plot = ggplot(survey_data, aes(x = TreatmentGroup, y = DiffLikertTreatedOriginal, fill = TreatmentGroup)) +
geom_boxplot() +
labs(title = "Boxplot of DiffLikertTreatedOriginal by Treatment Group",
x = "Treatment Group",
y = "DiffLikertTreatedOriginal") +
scale_fill_manual(values = c("human" = "#E69F00", "machine" = "#56B4E9", "placebo" = "#009E73")) +  # Optional custom colors
theme_minimal() +
theme(
plot.title = element_text(size = 18, face = "bold"),   # Larger title
axis.title = element_text(size = 14),                  # Larger axis titles
axis.text = element_text(size = 12),                   # Larger axis labels
legend.title = element_text(size = 14),                # Larger legend title
legend.text = element_text(size = 12)                  # Larger legend text
)
box_plot
ggsave("boxplot_diff_likert_treated_original.pdf",
plot = box_plot,  # Use the last plot created
device = "pdf",      # Specify PDF format
width = 8,           # Set width of the PDF (in inches)
height = 6,          # Set height of the PDF (in inches)
units = "in",        # Units for width and height
dpi = 300)
box_plot = ggplot(survey_data, aes(x = TreatmentGroup, y = DiffLikertTreatedOriginal, fill = TreatmentGroup)) +
geom_boxplot() +
labs(title = "Boxplot of DiffLikertTreatedOriginal by Treatment Group",
x = "Treatment Group",
y = "DiffLikertTreatedOriginal") +
scale_fill_manual(values = c("human" = "#E69F00", "machine" = "#56B4E9", "placebo" = "#009E73")) +  # Optional custom colors
theme_grey() +
theme(
plot.title = element_text(size = 18, face = "bold"),   # Larger title
axis.title = element_text(size = 14),                  # Larger axis titles
axis.text = element_text(size = 12),                   # Larger axis labels
legend.title = element_text(size = 14),                # Larger legend title
legend.text = element_text(size = 12)                  # Larger legend text
)
box_plot
ggsave("boxplot_diff_likert_treated_original.pdf",
plot = box_plot,  # Use the last plot created
device = "pdf",      # Specify PDF format
width = 8,           # Set width of the PDF (in inches)
height = 6,          # Set height of the PDF (in inches)
units = "in",        # Units for width and height
dpi = 300)
